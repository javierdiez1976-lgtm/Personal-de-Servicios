<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Opos JCyL: Personal de Servicios</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-slate-900 font-sans border-t-8 border-blue-700">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const EXAM_DATA =,
                correct: 0,
                note: "Las prendas planas se procesan en la calandra para asegurar el planchado y la desinfección térmica."
            },
            {
                id: "LIM_01",
                category: "Limpieza",
                question: "¿Qué significa el pictograma de un rombo rojo con una calavera?",
                options:,
                correct: 2,
                note: "Según el sistema GHS/CLP, la calavera indica toxicidad aguda (peligro de muerte)."
            },
            {
                id: "COM_01",
                category: "Comedor",
                question: "¿Cuál es la temperatura de seguridad para mantener alimentos calientes?",
                options: ["Más de 45°C", "Más de 55°C", "Más de 65°C", "Más de 75°C"],
                correct: 2,
                note: "Se debe mantener por encima de 65°C para evitar la proliferación de bacterias."
            }
        ];

        function App() {
            const [view, setView] = useState('home');
            const [mode, setMode] = useState('ord');
            const [current, setCurrent] = useState(0);
            const [answers, setAnswers] = useState({});
            const = useState(0);
            const [finished, setFinished] = useState(false);

            useEffect(() => {
                if (view === 'quiz' && timeLeft > 0 &&!finished) {
                    const timer = setInterval(() => setTimeLeft(t => t - 1), 1000);
                    return () => clearInterval(timer);
                } else if (timeLeft === 0 && view === 'quiz') setFinished(true);
            }, [view, timeLeft, finished]);

            const startExam = (m) => {
                setMode(m);
                setTimeLeft(m === 'ord'? 85 * 60 : 47 * 60);
                setView('quiz');
                setAnswers({});
                setCurrent(0);
                setFinished(false);
            };

            const speak = (t) => {
                const utter = new SpeechSynthesisUtterance(t);
                utter.lang = 'es-ES';
                window.speechSynthesis.speak(utter);
            };

            const getResults = () => {
                let hits = 0; let fails = 0;
                const penalty = mode === 'ord'? 0.25 : 0.11;
                EXAM_DATA.forEach((q, i) => {
                    if (answers[i] === q.correct) hits++;
                    else if (answers[i]!== undefined) fails++;
                });
                return (hits - (fails * penalty)).toFixed(2);
            };

            return (
                <div class="max-w-xl mx-auto p-6">
                    <header class="flex justify-between items-center mb-8 pb-4 border-b">
                        <h1 class="font-black text-blue-800 uppercase tracking-tighter">Opos JCyL Servicios</h1>
                        <button onClick={() => setView('home')} class="bg-gray-100 px-4 py-2 rounded-full text-xs font-bold">Inicio</button>
                    </header>

                    {view === 'home' && (
                        <div class="space-y-6">
                            <div class="bg-blue-50 p-6 rounded-2xl border border-blue-100">
                                <h2 class="text-xl font-bold text-blue-900">Preparación 2024-2025</h2>
                                <p class="text-sm text-blue-700">Acceso gratuito al temario oficial JCyL.</p>
                            </div>
                            <button onClick={() => startExam('ord')} class="w-full text-left bg-blue-700 text-white p-6 rounded-2xl shadow-lg">
                                <div class="font-bold text-lg">Examen Ordinario</div>
                                <div class="text-xs opacity-80">70 preguntas / 85 min / -0.25 error</div>
                            </button>
                            <button onClick={() => startExam('stab')} class="w-full text-left bg-indigo-600 text-white p-6 rounded-2xl shadow-lg">
                                <div class="font-bold text-lg">Estabilización (EE)</div>
                                <div class="text-xs opacity-80">40 preguntas / 47 min / -0.11 error</div>
                            </button>
                        </div>
                    )}

                    {view === 'quiz' &&!finished && (
                        <div>
                            <div class="flex justify-between text-xs font-bold mb-4">
                                <span class="text-blue-600 uppercase">{EXAM_DATA[current].category}</span>
                                <span class="text-red-600 font-mono text-lg">{Math.floor(timeLeft/60)}:{String(timeLeft%60).padStart(2,'0')}</span>
                            </div>
                            <h3 class="text-lg font-bold mb-6">{EXAM_DATA[current].question}</h3>
                            <div class="space-y-3">
                                {EXAM_DATA[current].options.map((o, i) => (
                                    <button key={i} onClick={() => setAnswers({...answers, [current]: i})}
                                        class={`w-full text-left p-4 rounded-xl border-2 transition ${answers[current] === i? 'border-blue-600 bg-blue-50' : 'border-gray-100 bg-white'}`}>
                                        <span class="font-black mr-2 text-blue-700">{String.fromCharCode(65+i)})</span> {o}
                                    </button>
                                ))}
                            </div>
                            <div class="flex justify-between mt-8">
                                <button disabled={current === 0} onClick={() => setCurrent(current-1)} class="text-gray-400 font-bold disabled:opacity-0">ANTERIOR</button>
                                {current < EXAM_DATA.length - 1 
                                   ? <button onClick={() => setCurrent(current+1)} class="bg-blue-700 text-white px-8 py-3 rounded-xl font-bold">SIGUIENTE</button>
                                    : <button onClick={() => setFinished(true)} class="bg-green-600 text-white px-8 py-3 rounded-xl font-bold">FINALIZAR</button>
                                }
                            </div>
                        </div>
                    )}

                    {finished && (
                        <div class="text-center py-10">
                            <h2 class="text-sm font-bold text-gray-400 uppercase">Nota Final</h2>
                            <div class="text-7xl font-black text-blue-700 my-4">{getResults()}</div>
                            <button onClick={() => setView('home')} class="mt-8 w-full bg-slate-900 text-white py-4 rounded-xl font-bold">REPETIR</button>
                        </div>
                    )}
                    
                    <footer class="mt-12 text-center text-[10px] text-gray-400">
                        Basado en BOCyL 29/11/2024. Material gratuito de apoyo.
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>